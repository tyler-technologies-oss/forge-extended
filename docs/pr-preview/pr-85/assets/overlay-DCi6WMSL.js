import{f as h,s as c,a as u,c as d}from"./floating-ui.dom-D-Vy2gwa.js";import{r as y,i as m,x as _}from"./iframe-BeV46OhB.js";import{t as v}from"./custom-element-BhZVzxrc.js";import{n as a}from"./property-D-RQOHWq.js";const f=":host{display:contents}.ai-overlay{position:relative;box-sizing:border-box;padding:0;margin:0;border:none;background:inherit;color:inherit;border-radius:inherit;overflow:visible}.ai-overlay[popover]{inset:unset}";var b=Object.defineProperty,g=Object.getOwnPropertyDescriptor,s=(t,e,l,n)=>{for(var i=n>1?void 0:n?g(e,l):e,r=t.length-1,p;r>=0;r--)(p=t[r])&&(i=(n?p(e,l,i):p(i))||i);return n&&i&&b(e,l,i),i};let o=class extends m{constructor(){super(...arguments),this.anchor=null,this.placement="bottom-start",this.flip=!0,this.shift=!1,this.open=!1,this._overlayElement=null,this._cleanupAutoUpdate=null,this._onToggle=t=>{this.open=t.newState==="open",this.dispatchEvent(new CustomEvent("forge-ai-overlay-toggle",{detail:{open:this.open,newState:t.newState,oldState:t.oldState},bubbles:!0,composed:!0}))}}disconnectedCallback(){super.disconnectedCallback(),this._cleanup()}updated(t){t.has("open")&&this._handleOpenChange(),(t.has("anchor")||t.has("placement")||t.has("flip")||t.has("shift"))&&this.open&&this._overlayElement&&this.anchor&&this._updatePosition()}_handleOpenChange(){this.open?this._showOverlay():this._hideOverlay()}async _showOverlay(){this._overlayElement||(await this.updateComplete,this._overlayElement=this.shadowRoot?.querySelector(".ai-overlay")),this._overlayElement&&(this._overlayElement.showPopover(),this.anchor&&this._updatePosition())}_hideOverlay(){this._overlayElement?.hidePopover(),this._cleanup()}_updatePosition(){if(!this.anchor||!this._overlayElement)return;this._cleanup();const t=[...this.flip?[h()]:[],...this.shift?[c({padding:8})]:[]];this._cleanupAutoUpdate=u(this.anchor,this._overlayElement,()=>this._computePosition(t))}async _computePosition(t){if(!(!this.anchor||!this._overlayElement))try{const e=await d(this.anchor,this._overlayElement,{placement:this.placement,middleware:t});Object.assign(this._overlayElement.style,{left:"0",top:"0",translate:`${this._roundByDPR(e.x)}px ${this._roundByDPR(e.y)}px`}),this.setAttribute("data-position-placement",e.placement)}catch(e){console.error("Failed to compute overlay position:",e)}}_roundByDPR(t){const e=window.devicePixelRatio||1;return Math.round(t*e)/e}_cleanup(){this._cleanupAutoUpdate?.(),this._cleanupAutoUpdate=null,this.removeAttribute("data-position-placement")}render(){return _`
      <div class="ai-overlay" popover="manual" @toggle=${this._onToggle}>
        <slot></slot>
      </div>
    `}};o.styles=y(f);s([a({type:Object})],o.prototype,"anchor",2);s([a()],o.prototype,"placement",2);s([a({type:Boolean})],o.prototype,"flip",2);s([a({type:Boolean})],o.prototype,"shift",2);s([a({type:Boolean,reflect:!0})],o.prototype,"open",2);o=s([v("forge-ai-overlay")],o);
