import { Meta, Title, Canvas } from '@storybook/addon-docs/blocks';
import CustomArgTypes from '../../blocks/CustomArgTypes';
import * as AppLayoutStories from './AppLayout.stories';

<Meta of={AppLayoutStories} />

<Title />

The `<forge-app-layout>` component provides a responsive layout structure for Tyler Cloud applications, featuring an embedded app bar with navigation drawer functionality. This component adapts automatically to different screen sizes, providing an optimal user experience across desktop and mobile devices.

The layout includes a built-in app bar with configurable slots and a responsive navigation system that transforms between a persistent side drawer on large screens and a modal drawer on smaller screens.

<Canvas of={AppLayoutStories.Demo} />

## Usage

The `<forge-app-layout>` component serves as the foundational layout structure for applications, providing both the app bar and navigation framework in a single, cohesive component.

```html
<forge-app-layout app-title="My Application">
  <!-- App bar content -->
  <img src="/logo.png" alt="Company Logo" slot="app-bar-logo" />
  <forge-button slot="app-bar-end" variant="raised">Action</forge-button>

  <!-- Navigation content -->
  <forge-list slot="navigation">
    <forge-list-item>
      <forge-icon slot="start" name="dashboard"></forge-icon>
      <button type="button">Dashboard</button>
    </forge-list-item>
    <forge-list-item>
      <forge-icon slot="start" name="people"></forge-icon>
      <button type="button">Users</button>
    </forge-list-item>
  </forge-list>

  <!-- Main content -->
  <main>
    <h1>Page Content</h1>
    <p>Your application content goes here.</p>
  </main>

  <!-- Footer -->
  <div slot="footer">
    <p>&copy; 2024 Tyler Technologies</p>
  </div>
</forge-app-layout>
```

## App Bar Integration

The component includes an embedded `<forge-app-bar>` with several configurable slots for custom content. The app bar automatically includes a menu button on small screens to control the navigation drawer.

### App Bar Slots

The app bar provides dedicated slots for different types of content:

- **Logo slot**: For company or application branding
- **Start slot**: For actions at the beginning of the app bar
- **Center slot**: For centered content like search bars
- **End slot**: For actions at the end of the app bar (user profile, settings, etc.)

```html
<forge-app-layout app-title="Dashboard">
  <!-- Logo in the app bar -->
  <forge-avatar slot="app-bar-logo" size="small">
    <img src="/company-logo.png" alt="Company" />
  </forge-avatar>

  <!-- Start actions -->
  <forge-button slot="app-bar-start" variant="text">
    <forge-icon name="refresh" slot="start"></forge-icon>
    Refresh
  </forge-button>

  <!-- Center content -->
  <forge-text-field slot="app-bar-center" placeholder="Search...">
    <forge-icon slot="leading" name="search"></forge-icon>
  </forge-text-field>

  <!-- End actions -->
  <forge-user-profile slot="app-bar-end" full-name="John Doe" email="john.doe@example.com"> </forge-user-profile>
</forge-app-layout>
```

## Responsive Behavior

The component automatically adapts to screen size using a configurable breakpoint (default: 768px):

### Large Screens (>= breakpoint)

- Navigation appears as a persistent drawer in the body-left area
- Menu button is hidden since navigation is always visible
- Full scaffold layout with dedicated navigation space

### Small Screens (< breakpoint)

- Navigation appears as a modal drawer triggered by the menu button
- Menu button becomes visible in the app bar start slot
- Drawer overlays content and can be toggled open/closed
- Drawer automatically closes when screen size increases

### Custom Breakpoint

You can customize the responsive breakpoint by setting the `breakpoint` property:

```html
<!-- Use a 1024px breakpoint instead of the default 768px -->
<forge-app-layout app-title="Desktop App" breakpoint="1024">
  <!-- Navigation will switch to drawer mode at 1024px -->
</forge-app-layout>

<!-- Use a smaller 600px breakpoint for mobile-first design -->
<forge-app-layout app-title="Mobile App" breakpoint="600">
  <!-- Navigation switches to drawer mode at 600px -->
</forge-app-layout>
```

## Navigation Content

The navigation slot accepts any content but works best with structured navigation elements like `<forge-list>`:

```html
<forge-app-layout app-title="Administration">
  <forge-list slot="navigation" navlist>
    <!-- Dashboard Section -->
    <forge-list-item>
      <forge-icon slot="start" name="dashboard"></forge-icon>
      <a href="/dashboard">Dashboard</a>
    </forge-list-item>

    <!-- Divider -->
    <forge-divider></forge-divider>

    <!-- Users Section -->
    <forge-list-item>
      <forge-icon slot="start" name="people"></forge-icon>
      <a href="/users">Users</a>
    </forge-list-item>
    <forge-list-item>
      <forge-icon slot="start" name="admin_panel_settings"></forge-icon>
      <a href="/roles">Roles & Permissions</a>
    </forge-list-item>
  </forge-list>
</forge-app-layout>
```

## Right Navigation

The component also supports right-side navigation through the `right-navigation` slot. This works identically to the left navigation but appears on the right side of the layout:

```html
<forge-app-layout app-title="Dashboard">
  <!-- Left navigation -->
  <forge-list slot="navigation" navlist>
    <forge-list-item>
      <forge-icon slot="start" name="dashboard"></forge-icon>
      <a href="/dashboard">Dashboard</a>
    </forge-list-item>
  </forge-list>

  <!-- Right navigation for tools/actions -->
  <forge-list slot="right-navigation" navlist>
    <forge-list-item>
      <forge-icon slot="start" name="add"></forge-icon>
      <button type="button">Create New</button>
    </forge-list-item>
    <forge-list-item>
      <forge-icon slot="start" name="settings"></forge-icon>
      <button type="button">Quick Settings</button>
    </forge-list-item>
  </forge-list>

  <!-- Main content -->
  <main>Your application content</main>
</forge-app-layout>
```

Like the main navigation, the right navigation automatically adapts to screen size:

- **Large screens**: Appears as a persistent drawer on the right side
- **Small screens**: Appears as a modal drawer triggered by a right-side menu button in the app bar

## Layout Slots

Beyond the app bar and navigation, the component provides additional layout slots for content placement:

- **Default slot**: Main content area
- **Body slots**: `body-header`, `body-footer`, `body-left`, `body-right` for additional content areas
- **Footer slot**: Application footer content

```html
<forge-app-layout app-title="Complex Layout">
  <!-- Navigation -->
  <nav slot="navigation">...</nav>

  <!-- Body header -->
  <div slot="body-header">
    <forge-toolbar>
      <h1>Page Title</h1>
      <forge-button slot="end">Action</forge-button>
    </forge-toolbar>
  </div>

  <!-- Main content (default slot) -->
  <main>
    <h2>Primary Content</h2>
    <p>Your main application content.</p>
  </main>

  <!-- Body footer -->
  <div slot="body-footer">
    <forge-pagination></forge-pagination>
  </div>

  <!-- Application footer -->
  <footer slot="footer">
    <p>&copy; 2024 Tyler Technologies. All rights reserved.</p>
  </footer>
</forge-app-layout>
```

## Page Toolbar Component

The app-layout component includes an optional page-level toolbar component (`<forge-page-toolbar>`) that appears when a `pageTitle` is provided. This nested component is specifically designed for data-heavy applications and features a more compact, dense styling compared to standard toolbars.

### Features

- **Compact Design**: Reduced height and padding optimized for information-dense interfaces
- **Optional Back Arrow**: Configurable back navigation button with visual separator
- **Flexible Content Areas**: Center and end slots for additional page-level actions
- **Consistent Styling**: Integrates seamlessly with the overall layout design

### Usage

The page toolbar is automatically rendered when you set the `pageTitle` property:

```html
<forge-app-layout app-title="Data Management" page-title="User Analytics">
  <!-- Optional content for the page toolbar -->
  <forge-text-field slot="page-toolbar-center" placeholder="Search users...">
    <forge-icon slot="leading" name="search"></forge-icon>
  </forge-text-field>

  <forge-button slot="page-toolbar-end" variant="outlined">
    <forge-icon slot="start" name="download"></forge-icon>
    Export Data
  </forge-button>
</forge-app-layout>
```

### Customization

You can control the back arrow visibility:

```html
<!-- Hide the back arrow for root pages -->
<forge-app-layout app-title="Admin Portal" page-title="Dashboard" show-secondary-back-arrow="false"> </forge-app-layout>

<!-- Show back arrow for nested pages (default) -->
<forge-app-layout app-title="Admin Portal" page-title="User Details" show-secondary-back-arrow="true">
</forge-app-layout>
```

The page toolbar is particularly useful for:

- **Administrative interfaces** with multiple levels of navigation
- **Data management screens** requiring compact header space
- **Detail views** that need contextual actions and navigation
- **Dashboard pages** with filtering or search capabilities

## API

<CustomArgTypes />

## Accessibility

- The embedded menu button includes appropriate focus management and keyboard navigation
- Navigation drawer follows standard dialog accessibility patterns when in modal mode
- App bar maintains proper heading structure and landmark roles
- All slots support proper semantic markup for screen readers
- Responsive behavior maintains keyboard accessibility across screen sizes
